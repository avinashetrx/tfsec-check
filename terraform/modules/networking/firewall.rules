pass http ${BASTION_SUBNETS}    [1024:]  -> any                   80      (http.host; content:"example.com"; startswith; endswith; msg:"Allow HTTP traffic to example.com"; flow:to_server; sid:1; rev:1;)
pass tls  ${BASTION_SUBNETS}    [1024:]  -> any                   443     (tls.sni; content:"http.cat"; startswith; nocase; endswith; msg:"Allow TLS (HTTPS) traffic to http.cat"; flow:to_server; sid:2; rev:1;)


# The drop http and tls seem to kick in earlier than only dropping established TCP flows
drop http any                   any      -> any                   any     (msg:"Drop other HTTP traffic"; sid:1001; rev:1;)
drop tls  any                   any      -> any                   any     (msg:"not matching any TLS allowlisted FQDNs"; sid:1002; rev:1;)
drop tcp  any                   any      -> any                   any     (msg:"Drop remaining estabilshed TCP traffic"; flow:established; sid:1003; rev:1;)
# Non-TCP traffic should already have been dropped by the stateless rules, but just to be sure
drop ip   any                   any      <> any                   any     (msg: "Drop non-TCP traffic"; ip_proto:!TCP;sid:1004; rev:1;)
